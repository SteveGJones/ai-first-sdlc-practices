# Migration Guide: v1.7.0 to v1.8.0

**Release Date:** 2026-02-10
**Migration Complexity:** LOW - Additive Changes (agent upgrades are optional)
**Estimated Time:** 5-15 minutes

---

## Overview

Version 1.8.0 introduces the **Agent Upgrade Protocol** and the **Agent Creation Pipeline**. This release focuses on the agent ecosystem:

- 65 agents now available (up from 31 in the v2 manifest)
- 42 agents rebuilt via systematic research pipeline with CRAAP source evaluation
- 4 new Agent Creation Pipeline agents for building custom domain-specific agents
- v3-setup-orchestrator now handles agent upgrades natively
- Two upgrade modes: Full Upgrade and Pipeline-Only

---

## What's New

1. **Agent Upgrade Protocol** - v3-setup-orchestrator can now upgrade agents in-place with backup, manifest comparison, and two modes
2. **42 Research-Rebuilt Agents** - Grounded in systematic web research using CRAAP source evaluation, not generic LLM generation
3. **Agent Creation Pipeline** (4 new agents):
   - `pipeline-orchestrator`: Unified entry point for agent creation
   - `agent-builder`: Constructs agents from research synthesis using 5 reference archetypes
   - `deep-research-agent`: Executes web research campaigns with source evaluation
   - `repo-knowledge-distiller`: Analyzes repositories to extract agent knowledge
4. **35 New Agent Specializations** including security-architect, cloud-architect, frontend-architect, data-architect, mobile-architect, code-review-specialist, and more
5. **Agent Manifest v3.1.0** with full agent metadata, path resolution, and dependency tracking
6. **Research Prompt Library** - 50+ structured research prompts and synthesis outputs in `agent_prompts/`
7. **Reference Agent Archetypes** - 5 templates (Domain Expert, Architect, Reviewer, Orchestrator, Enforcer) for building new agents

---

## Step-by-Step Migration

### Step 1: Update the v3-setup-orchestrator

```bash
# Download the latest orchestrator to your project
curl -s https://raw.githubusercontent.com/SteveGJones/ai-first-sdlc-practices/main/agents/v3-setup-orchestrator.md > .claude/agents/v3-setup-orchestrator.md
```

### Step 2: Restart Claude Code

Required for the updated orchestrator to load.

### Step 3: Run the Smart Upgrade

Tell your AI assistant:
```
Use the v3-setup-orchestrator to upgrade my agents
```

The orchestrator will:
1. **Analyze your project** - detect languages, frameworks, and project type
2. **Select the right agents** - choose agents that match your project's needs
3. **Always include the pipeline** - the 4 Agent Creation Pipeline agents are always added
4. **Show you the plan** - list new agents to install and existing agents with newer versions
5. **Ask before upgrading** - for any agent you already have where a newer research-rebuilt version exists, you choose: upgrade all, pick individually, or skip upgrades
6. **Preserve everything** - custom agents you created are never touched, originals are backed up before any upgrade

### Step 4: Restart Claude Code Again

Required for newly downloaded agents to load.

### Step 5: Update Framework Files (Optional)

```bash
# Update CLAUDE-CORE.md if you want the latest framework instructions
curl -s https://raw.githubusercontent.com/SteveGJones/ai-first-sdlc-practices/main/CLAUDE-CORE.md > CLAUDE-CORE.md
```

### Step 6: Update VERSION

```bash
echo "1.8.0" > VERSION
```

### Step 7: Commit Changes

```bash
git add .claude/agents/ VERSION
git commit -m "feat: upgrade to v1.8.0 with research-rebuilt agents

- Upgraded agents to research-rebuilt v3.1.0 versions
- Added Agent Creation Pipeline (4 agents)
- 65 total agents available (up from 31)"
```

---

## Validation

After migration, verify everything is working:

```bash
# 1. Check agent count
agent_count=$(ls -1 .claude/agents/*.md 2>/dev/null | wc -l | tr -d ' ')
echo "Agents installed: $agent_count"
# Expected: 65+ for full upgrade, or previous count + 4 for pipeline-only

# 2. Verify critical core agents
for agent in sdlc-enforcer critical-goal-reviewer solution-architect; do
    if [ -f ".claude/agents/${agent}.md" ]; then
        echo "OK: ${agent}"
    else
        echo "MISSING: ${agent}"
    fi
done

# 3. Verify pipeline agents
for agent in pipeline-orchestrator agent-builder deep-research-agent repo-knowledge-distiller; do
    if [ -f ".claude/agents/${agent}.md" ]; then
        echo "OK: ${agent} (pipeline)"
    else
        echo "MISSING: ${agent} (pipeline)"
    fi
done

# 4. Check VERSION
cat VERSION
# Expected: 1.8.0
```

---

## Impact on AI Behavior

After this update:

### Research-Rebuilt Agents
All 42 rebuilt agents are grounded in systematic web research with CRAAP source evaluation. This means:
- More accurate and current domain knowledge
- Specific tool versions, standards, and methodologies referenced
- Actionable decision frameworks based on real-world practices
- Anti-pattern catalogs drawn from documented failures

### Agent Creation Pipeline
Users can now create custom domain-specific agents:
1. Describe your domain need to the `pipeline-orchestrator`
2. It routes to `deep-research-agent` (web) or `repo-knowledge-distiller` (internal repos)
3. Research synthesis is fed to `agent-builder` for construction
4. The result is a validated, production-quality agent file

---

## Rollback Instructions

If you need to rollback:

```bash
# 1. Restore agents from backup (full upgrade only)
BACKUP=$(ls -td .claude/agents-backup-* 2>/dev/null | head -1)
if [ -n "$BACKUP" ]; then
    cp "$BACKUP"/*.md .claude/agents/
    echo "Restored from $BACKUP"
else
    echo "No backup found"
fi

# 2. Or remove pipeline agents only (pipeline-only upgrade)
rm -f .claude/agents/pipeline-orchestrator.md
rm -f .claude/agents/agent-builder.md
rm -f .claude/agents/deep-research-agent.md
rm -f .claude/agents/repo-knowledge-distiller.md

# 3. Restore VERSION
echo "1.7.0" > VERSION
```

---

## Troubleshooting

**Issue**: Agent download fails (empty file)
**Solution**: Check network connectivity. Retry the specific download:
```bash
curl -s https://raw.githubusercontent.com/SteveGJones/ai-first-sdlc-practices/main/agents/{category}/{agent-name}.md > .claude/agents/{agent-name}.md
```

**Issue**: Agent not loading after download
**Solution**: Restart Claude Code. Agents only load at startup.

**Issue**: Custom agent overwritten during full upgrade
**Solution**: Restore from `.claude/agents-backup-{date}/`. The upgrade protocol preserves custom agents not in the official manifest, but the backup exists as a safety net.

**Issue**: "v3-setup-orchestrator not found" after download
**Solution**: Verify the file exists: `ls -la .claude/agents/v3-setup-orchestrator.md`. Restart Claude Code.

**Issue**: Manifest fetch fails
**Solution**: Check if you can reach GitHub: `curl -s https://raw.githubusercontent.com/SteveGJones/ai-first-sdlc-practices/main/VERSION`. If blocked, download agents individually using the URLs in the [Agent Creation Guide](../AGENT-CREATION-GUIDE.md).
