# Migration Guide: v1.6.0 to v1.7.0

**Release Date:** 2025-07-27  
**Migration Complexity:** MEDIUM - Additive Changes  
**Estimated Time:** 15-30 minutes

---

## üéØ Overview

Version 1.7.0 introduces **AI-First Logging Standards** that teach AI agents WHERE to add logging, WHAT to log, and HOW to ensure quality observability in production systems.

---

## üìã What's New

1. **Compressed Logging Rules** in CLAUDE-CORE.md (11 lines)
2. **Detailed Logging Context** in CLAUDE-CONTEXT-logging.md
3. **Logging Compliance Validator** check-logging-compliance.py
4. **7th Architecture Document** observability-design.md
5. **Enhanced Setup Script** with logging file deployment

---

## üöÄ Step-by-Step Migration

### Step 1: Download New Files

```bash
# 1. Download the logging context file
curl -sSL https://raw.githubusercontent.com/SteveGJones/ai-first-sdlc-practices/main/CLAUDE-CONTEXT-logging.md > CLAUDE-CONTEXT-logging.md

# 2. Download the logging compliance checker
mkdir -p tools/validation
curl -sSL https://raw.githubusercontent.com/SteveGJones/ai-first-sdlc-practices/main/tools/validation/check-logging-compliance.py > tools/validation/check-logging-compliance.py
chmod +x tools/validation/check-logging-compliance.py

# 3. Download the observability design template
mkdir -p templates/architecture
curl -sSL https://raw.githubusercontent.com/SteveGJones/ai-first-sdlc-practices/main/templates/architecture/observability-design.md > templates/architecture/observability-design.md
```

### Step 2: Update CLAUDE-CORE.md

Add the following section after the Zero Technical Debt section (around line 33):

```markdown
## Logging (MANDATORY)

### Required Logging Points:
1. Function entry/exit (with context)
2. Errors (with stack trace)
3. External calls (APIs/DB)
4. State changes & security events

### FORBIDDEN: Passwords, tokens, SSNs, credit cards in logs

Details: Load CLAUDE-CONTEXT-logging.md
```

### Step 3: Update Context Loading Table

In CLAUDE-CORE.md, add this line to the context loading table:

```markdown
| Logging standards | CLAUDE-CONTEXT-logging.md |
```

### Step 4: Update Architecture Requirements

The framework now requires 7 architecture documents (was 6):

1. requirements-traceability-matrix.md
2. what-if-analysis.md
3. architecture-decision-record.md
4. system-invariants.md
5. integration-design.md
6. failure-mode-analysis.md
7. **observability-design.md** (NEW)

Update any documentation that references "6 required documents" to "7 required documents".

### Step 5: (Optional) Integrate with Validation Pipeline

To add logging checks to your CI/CD pipeline, update `tools/validation/validate-pipeline.py`:

```python
# Add to check choices
@click.option('--checks', multiple=True, 
              type=click.Choice(['branch', 'proposal', 'retrospective', 'architecture', 
                                'technical-debt', 'type-safety', 'logging']),
              help='Specific checks to run')

# Add check function
def check_logging_compliance():
    """Check logging compliance"""
    print("\nüìã Checking Logging Compliance...")
    result = subprocess.run(
        ["python", "tools/validation/check-logging-compliance.py", "--threshold", "0"],
        capture_output=True,
        text=True
    )
    if result.returncode != 0:
        return False, "Logging compliance check failed"
    return True, "Logging compliance check passed"

# Add to validation flow
if not checks or 'logging' in checks:
    success, message = check_logging_compliance()
    results['logging'] = {'success': success, 'message': message}
    if not success:
        all_passed = False
```

### Step 6: Update VERSION

```bash
echo "1.7.0" > VERSION
```

### Step 7: Commit Changes

```bash
git add -A
git commit -m "feat: upgrade to v1.7.0 with AI-First Logging Standards

- Added mandatory logging at 6 key points
- Created CLAUDE-CONTEXT-logging.md with examples
- Added check-logging-compliance.py validator
- Added observability-design.md as 7th architecture doc
- Updated setup-smart.py to deploy logging files"
```

---

## ‚úÖ Validation

After migration, verify everything is working:

```bash
# 1. Check all files exist
ls -la CLAUDE-CONTEXT-logging.md
ls -la tools/validation/check-logging-compliance.py
ls -la templates/architecture/observability-design.md

# 2. Verify CLAUDE-CORE.md has logging section
grep -A5 "## Logging" CLAUDE-CORE.md

# 3. Test the logging validator
python tools/validation/check-logging-compliance.py --help

# 4. Run a compliance check (expect violations initially)
python tools/validation/check-logging-compliance.py
```

---

## üìä Impact on AI Behavior

After this update, AI agents will automatically:

### ‚úÖ DO:
- Add entry/exit logs with context for functions
- Include stack traces in error logs
- Log all external API/database calls
- Track state changes and security events
- Use structured logging formats
- Include correlation IDs for tracing

### ‚ùå DON'T:
- Log passwords, tokens, or API keys
- Log full credit card numbers or SSNs
- Use generic messages like "error occurred"
- Skip logging in error handlers
- Create high-frequency logs without sampling

---

## üîÑ Rollback Instructions

If you need to rollback:

```bash
# 1. Restore previous VERSION
echo "1.6.0" > VERSION

# 2. Remove logging section from CLAUDE-CORE.md

# 3. Remove logging files
rm -f CLAUDE-CONTEXT-logging.md
rm -f tools/validation/check-logging-compliance.py
rm -f templates/architecture/observability-design.md

# Note: We recommend adapting to the new standards instead
```

---

## üéØ Expected Outcomes

1. **Immediate**: Logging validation will show violations in existing code
2. **Short-term**: New AI-generated code will include proper logging
3. **Long-term**: 50% reduction in debugging time due to better observability

---

## üÜò Troubleshooting

**Issue**: Import errors in check-logging-compliance.py  
**Solution**: Ensure Python 3.8+ is installed

**Issue**: Many logging violations detected  
**Solution**: This is expected for existing code. Focus on new code going forward.

**Issue**: CLAUDE-CORE.md exceeds size limits  
**Solution**: The logging section is only 11 lines. Remove other non-essential content if needed.

**Issue**: Validation tool runs slowly  
**Solution**: Use path argument to check specific directories: `python tools/validation/check-logging-compliance.py src/`

---

## üìù Configuration Options

Create `.logging-config.yaml` for exemptions:

```yaml
exemptions:
  - pattern: "get*"
    reason: "Simple getters don't need logging"
  - pattern: "*_test.py"
    reason: "Test files have different logging needs"
  - file: "src/utils/pure_functions.py"
    reason: "Pure mathematical functions"
```

---

## üöÄ Next Steps

1. Run logging compliance check on your codebase
2. Review violations and add exemptions where appropriate
3. Ensure all new features include observability-design.md
4. Monitor improvement in AI-generated code quality

Remember: Good logging is the difference between debugging for hours and finding issues in minutes!